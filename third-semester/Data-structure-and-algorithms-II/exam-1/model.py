from keras.models import Sequential
from keras.layers import Dense
from graphing import *


def training():
    model = Sequential()

    model.add(Dense(12, input_dim=3, activation='relu'))
    model.add(Dense(1, activation='sigmoid'))

    model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])

    X = [[1506114.0, 12495, 120.53], [1506570.0, 12471, 120.8], [1509744.0, 12487, 120.9], [1520307.0, 12543, 121.2], 
        [28244.0, 247, 113.89], [30669.0, 257, 118.87], [30622.0, 256, 119.15], [28860.0, 236, 121.77],
        [150371.0, 1267, 118.59], [152979.0, 1276, 119.8], [145220.0, 1202, 120.71], [153385.0, 1251, 122.51],
        [298455.0, 2500, 119.33], [294237.0, 2462, 119.46], [292291.0, 2439, 119.79], [311376.0, 2595, 119.94],
        [203918.0, 1706, 119.46], [214816.0, 1787, 120.14], [210095.0, 1732, 121.23], [214999.0, 1771, 121.33],
        [597522.0, 4994, 119.62], [624925.0, 5173, 120.78], [599303.0, 4958, 120.85], [591112.0, 4871, 121.33],
        [16990.0, 155, 108.91], [19171.0, 168, 113.44], [21066.0, 173, 121.07], [18971.0, 154, 122.39],
        [5126.0, 42, 119.21], [6518.0, 49, 130.36], [9207.0, 68, 133.43], [5186.0, 37, 136.47],
        [303031.0, 2567, 118.0], [285641.0, 2416, 118.18], [300692.0, 2502, 120.13], [303096.0, 2511, 120.66]]

    Y = [0, 0, 0, 0, 
         1, 1, 1, 0, 
         1, 1, 0, 0, 
         1, 1, 1, 1, 
         1, 0, 0, 0, 
         1, 0, 0, 0, 
         1, 1, 0, 0,
         1, 0, 0, 0,
         1, 1, 0, 0]

    historial = model.fit(X, Y, epochs=5000, batch_size=10, verbose=False)

    graphingNeuralNetwork(historial)

    model.save('saved_model/my_model')

    return model
